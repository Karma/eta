ETA Framework
=============

The ETA framework is a Javascript library that you can use to compute the difficulty of an Amazon Mechanical Turk task. It computes the error-time curve and error-time area under the curve (ETA) for the task.

This framework is based on the methodology described in [this paper](http://hci.stanford.edu/publications/2015/eta/eta.pdf
).

Demo
----
See a [demonstration](https://files.clr3.com/eta/examples/multiple-choice_demo.html) of the interface ETA generates to evaluate the difficulty of a task.

By running this task on Mechanical Turk, the ETA framework can generate an error-time curve, and compute the ETA for a task:

![ETA](https://files.clr3.com/eta/web/eta.png)

More examples of such curves can be found in [the paper](http://hci.stanford.edu/publications/2015/eta/eta.pdf).

Requirements
------------
* [Python, numpy, scipy, and matplotlib](http://www.scipy.org/install.html)

Getting Started
---------------
To get a feel of what ETA tasks look like, you might want to peruse the `examples` folder before continuing.

The key idea behind ETA is to limit the amount of time workers have to complete a task, and measure worker accuracy given different time limits.

Thus, to compute the ETA of a task using this framework, you'll need:

* HTML template of the task (i.e. what does your task look like on Mechanical Turk?)
* Task options (i.e., how long do you expect people are going to take?)
* Data for the task (e.g., a list of images and possible options for each image)

First, you'll need to define your task options and a HTML template for your task in a single HTML file (see the `examples` folder for the includes required.)

For instance, this task template is for a multiple-choice question:

    <div class="base_q">
      <div><img src="#IMG_URL#"></div>
      <div>
        Pick a label that best applies to this image.
        <label><input type="radio" name="answer" value="#LABEL1#"> #LABEL1#</label>
        <label><input type="radio" name="answer" value="#LABEL2#"> #LABEL2#</label>
        <label><input type="radio" name="answer" value="#LABEL3#"> #LABEL3#</label>
        <label><input type="radio" name="answer" value="#LABEL4#"> #LABEL4#</label>
      </div>
    </div>

The options for this task are defined as a JSON object:

    var question_metadata = {
        time_limits: [0.5, 1.0, 1.5, 2.0, 3.0, 4.0, 5.0],  # Possible time limits
        num_reps: [3, 3, 3, 3, 3, 3, 3],                   # Number of repetitions for each time limit
        practice_time_limit: 8,                            # Time limit for the practice questions
        practice_num_reps: 3                               # Number of Practice Questions
      };

Here, I'm guessing that people may take anywhere from 0.5 to 5 seconds to complete this task, so I've defined seven time limits in that range. In practice, you'll want at least seven unique time limits to generate a reliable error-time curve.

Last, you'll need data to populate this template. This is identical to the data file that you'd upload to Mechanical Turk for a regular task, only now you provide it directly to ETA instead as a JSON object. Data can be provided inline, or remotely using JSON callback (see the `examples` for how this can be done). Note here that the columns of this CSV file correspond to the variables defined in the template (e.g., "IMGURL" and "LABEL1"). The correct answer for a question defined in the "ANSWER" column, while the input name in the template is correspondingly "answer".

    IMG_URL,LABEL1,LABEL2,LABEL3,LABEL4,ANSWER
    http://...png,jumping,waving,climbing,brushing,waving
    http://...png,eating,cooking,waving,jumping,jumping
    ...

After you've prepared the necessary HTML file, paste the HTML code as into Mechanical Turk:

![Pasting code into Mechanical Turk](https://files.clr3.com/eta/web/mturk1.png)

After the task completes, download the output CSV from Mechanical Turk. At this stage, you'll need two files to generate the ETA: your original CSV file (`data.csv`), and the CSV file generated by Mechanical Turk (`results.csv`).

Run `python process.py` in the directory containing these two files to obtain the error-time curve and ETA for the task (See `python process.py -h` for more help). Three files will be generated:

* eta.png - A plot of the generated ETA curve
* eta.csv - The processed data used to generate the curve
* eta.txt - Additional useful information

Examples
--------
The `examples` folder contains sample code for how this library can be used.

Each example comes with two files: `demo.html` can be opened directly in your browser, and the code in `mturk.html` can be copied directly into Mechanical Turk as a single HIT.

* `multiple-choice` - Multiple choice task
* `multiple-choice-remote` - Multiple choice task, with data loaded remotely

Notes
-----
* The latest version of the code is hosted on http://clr3.com for easy inclusion in Mechanical Turk tasks. If you'd like to host your own version, note that your web server must be https-enabled.

Contributing
------------
If you are interested in contributing to the development of ETA, keep reading!

Source files are included in the `src` folder. To build ETA, first run these commands:
    
    brew install node
    npm install clean-css -g
    pip install pyminifier

and then run `./build.sh` from `src`, which will output ETA to the `releases` folder.

License
-------
ETA is released under the [MIT License](http://www.opensource.org/licenses/MIT).
